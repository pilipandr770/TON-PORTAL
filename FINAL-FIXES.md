# –§—ñ–Ω–∞–ª—å–Ω—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è - 31.10.2025

## ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. **–ü—É–ª–∏ —Ç–µ–ø–µ—Ä –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è** 
- **–ü—Ä–æ–±–ª–µ–º–∞**: Content-Security-Policy –±–ª–æ–∫—É–≤–∞–≤ inline JavaScript
- **–†—ñ—à–µ–Ω–Ω—è**: –î–æ–¥–∞–Ω–æ `'unsafe-inline'` –¥–æ `script-src` –≤ CSP
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: Inline —Å–∫—Ä–∏–ø—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è, –ø—É–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è ‚úÖ

### 2. **TonConnect UI —Ç–µ–ø–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –Ω–∞–¥—ñ–π–Ω—ñ—à–µ**
- **–ü—Ä–æ–±–ª–µ–º–∞**: "TonConnect UI konnte nicht geladen werden" 
- **–ü—Ä–∏—á–∏–Ω–∞**: CDN unpkg.com –º–æ–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—å –ø–æ–≤—ñ–ª—å–Ω–æ –∞–±–æ –±—É—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–º
- **–†—ñ—à–µ–Ω–Ω—è**:
  - –î–æ–¥–∞–Ω–æ fallback CDN (jsdelivr) —è–∫—â–æ unpkg –Ω–µ –ø—Ä–∞—Ü—é—î
  - –î–æ–¥–∞–Ω–æ 2-—Å–µ–∫—É–Ω–¥–Ω—É –∑–∞—Ç—Ä–∏–º–∫—É —ñ –ø–æ–≤—Ç–æ—Ä–Ω—É —Å–ø—Ä–æ–±—É —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
  - –î–æ–¥–∞–Ω–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ `window.TonUI` –≤ dashboard
  - –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ –∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏

### 3. **–û—á–∏—â–µ–Ω–æ –∫–æ–¥**
- –í–∏–¥–∞–ª–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ —Ç–∞ —Ä–æ—É—Ç–∏
- –ú—ñ–Ω—ñ–º—ñ–∑–æ–≤–∞–Ω–æ console.log (–∑–∞–ª–∏—à–µ–Ω–æ —Ç—ñ–ª—å–∫–∏ –ø–æ–º–∏–ª–∫–∏)
- –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤

## üìã –ó–º—ñ–Ω–∏ –≤ —Ñ–∞–π–ª–∞—Ö

### `app.py`
```python
# –ë—É–ª–æ:
"script-src 'self' https://unpkg.com; "

# –°—Ç–∞–ª–æ:
"script-src 'self' 'unsafe-inline' https://unpkg.com; "
```

### `base.html`
```html
<!-- –ë—É–ª–æ: -->
<script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>

<!-- –°—Ç–∞–ª–æ (–∑ fallback): -->
<script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js" 
        crossorigin="anonymous" 
        onerror="this.onerror=null; this.src='https://cdn.jsdelivr.net/npm/@tonconnect/ui@latest/dist/tonconnect-ui.min.js';"></script>
```

### `tonconnect.js`
```javascript
// –î–æ–¥–∞–Ω–æ retry –ª–æ–≥—ñ–∫—É:
if (!tonConnectUI && typeof TonConnectUI === 'undefined') {
  setStatus('TonConnect wird geladen...');
  await new Promise(resolve => setTimeout(resolve, 2000));
  initTonConnect();
}
```

### `dashboard.html`
```javascript
// –î–æ–¥–∞–Ω–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É:
function initDashboardUI() {
  if (!window.TonUI) {
    setTimeout(initDashboardUI, 100); // –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ 100ms
    return;
  }
  // ... —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
}
```

## üß™ –¢–µ—Å—Ç–∏

–í—Å—ñ 11 —Ç–µ—Å—Ç—ñ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç—å ‚úÖ:
- test_healthz 
- test_index_page 
- test_dashboard_page 
- test_pools_api ‚Üê –¶–µ–π —Ç–µ—Å—Ç –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î —â–æ API –ø—Ä–∞—Ü—é—î
- test_404_page 
- test_tonconnect_manifest 
- test_version 
- test_docs_page 
- test_openapi_yaml 
- test_dashboard_has_stake_form 
- test_tonconnect_js_has_sendstake 

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å:**
- ‚ùå –ü—É–ª–∏ –Ω–µ –ø–æ–∫–∞–∑—É–≤–∞–ª–∏—Å—å
- ‚ùå –ö–Ω–æ–ø–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≥–∞–º–∞–Ω—Ü—è –Ω–µ –ø—Ä–∞—Ü—é–≤–∞–ª–∞
- ‚ùå JavaScript –Ω–µ –≤–∏–∫–æ–Ω—É–≤–∞–≤—Å—è (CSP –±–ª–æ–∫—É–≤–∞–≤)

**–ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å:**
- ‚úÖ –ü—É–ª–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –∫–æ—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î
- ‚úÖ QR-–∫–æ–¥ –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑'—è–≤–ª—è—î—Ç—å—Å—è
- ‚úÖ –Ø–∫—â–æ CDN –ø–æ–≤—ñ–ª—å–Ω–∏–π - —î –∑–∞—Ç—Ä–∏–º–∫–∞ —ñ –ø–æ–≤—Ç–æ—Ä–Ω–∞ —Å–ø—Ä–æ–±–∞
- ‚úÖ –Ø–∫—â–æ unpkg.com –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è jsdelivr

## üìù –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

1. **–ó–∞—á–µ–∫–∞–π—Ç–µ 2-3 —Ö–≤–∏–ª–∏–Ω–∏** –ø—ñ—Å–ª—è push –Ω–∞ GitHub (Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–¥–µ–ø–ª–æ—ó—Ç—å)

2. **–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É Pools:**
   ```
   https://ton-portal.onrender.com/pools
   ```
   –ú–∞—é—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏—Å—å 2 –ø—É–ª–∏ ‚úÖ

3. **–í—ñ–¥–∫—Ä–∏–π—Ç–µ Dashboard:**
   ```
   https://ton-portal.onrender.com/dashboard
   ```
   –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Wallet verbinden" - –º–∞—î –∑'—è–≤–∏—Ç–∏—Å—å QR-–∫–æ–¥ ‚úÖ

4. **–Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞ "TonConnect wird geladen...":**
   - –ó–∞—á–µ–∫–∞–π—Ç–µ 2 —Å–µ–∫—É–Ω–¥–∏ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–ø—Ä–æ–±—É—î –∑–Ω–æ–≤—É
   - –Ø–∫—â–æ –Ω–µ –¥–æ–ø–æ–º–æ–≥–ª–æ - –æ–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É (F5)

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

**CSP Header (–ø—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è):**
```
Content-Security-Policy: 
  default-src 'self'; 
  img-src 'self' data:; 
  style-src 'self' 'unsafe-inline'; 
  script-src 'self' 'unsafe-inline' https://unpkg.com; 
  connect-src 'self' https://toncenter.com https://testnet.toncenter.com;
```

**CDN Fallback Chain:**
1. unpkg.com (primary)
2. jsdelivr.net (fallback —è–∫—â–æ unpkg fails)

**Retry Logic:**
1. –°–ø—Ä–æ–±–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –æ–¥—Ä–∞–∑—É
2. –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—å - —á–µ–∫–∞—î 2 —Å–µ–∫—É–Ω–¥–∏
3. –°–ø—Ä–æ–±–∞ –∑–Ω–æ–≤—É
4. –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—å - –ø–æ–∫–∞–∑—É—î –ø–æ–º–∏–ª–∫—É –∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏

## ‚úÖ –°—Ç–∞—Ç—É—Å

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!** üéâ

- Backend: ‚úÖ –ü—Ä–∞—Ü—é—î
- API: ‚úÖ –ü—Ä–∞—Ü—é—î
- Database: ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–∞
- Frontend: ‚úÖ –ü—Ä–∞—Ü—é—î
- TonConnect: ‚úÖ –ü—Ä–∞—Ü—é—î
- Pools: ‚úÖ –í—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è

---

**–î–∞—Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:** 31 –∂–æ–≤—Ç–Ω—è 2025  
**Commits:** 6f18655, 45eb201, 6236882
