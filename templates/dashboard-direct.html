<!-- file: templates/dashboard-direct.html -->
{% extends "base.html" %}
{% block content %}
<h1>Dashboard (Direct Connection Mode)</h1>

<div class="card" style="background: #2a1a1a; border: 2px solid #f90;">
  <h3>‚ö†Ô∏è WebSocket Bridge –ù–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π</h3>
  <p>TON Bridge —Å–µ—Ä–≤–µ—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ –∑ –≤–∞—à–æ—ó –º–µ—Ä–µ–∂—ñ. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ <strong>–ø—Ä—è–º—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</strong> –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≥–∞–º–∞–Ω—Ü—è:</p>
</div>

<div class="card">
  <h3>–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≥–∞–º–∞–Ω—Ü—è (Direct Links)</h3>
  
  <p>–í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—à –≥–∞–º–∞–Ω–µ—Ü—å –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:</p>
  
  <div style="display: grid; gap: 12px; margin-top: 20px;">
    <a href="https://app.tonkeeper.com/ton-connect?v=2&id={{ app_id }}&r={{ return_url }}" 
       class="btn btn-primary" 
       style="display: flex; align-items: center; justify-content: center; padding: 16px;">
      <span style="font-size: 1.2em;">üì± Tonkeeper</span>
    </a>
    
    <a href="https://tonhub.com/ton-connect?v=2&id={{ app_id }}&r={{ return_url }}" 
       class="btn btn-primary"
       style="display: flex; align-items: center; justify-content: center; padding: 16px;">
      <span style="font-size: 1.2em;">üè¶ Tonhub</span>
    </a>
    
    <a href="https://t.me/wallet?attach=wallet&startattach=tonconnect_v2_{{ app_id }}_{{ return_url }}" 
       class="btn btn-primary"
       style="display: flex; align-items: center; justify-content: center; padding: 16px;">
      <span style="font-size: 1.2em;">‚úàÔ∏è Telegram Wallet</span>
    </a>
  </div>
  
  <p style="margin-top: 20px; color: #888; font-size: 0.9em;">
    üí° –ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–æ–∫ –≥–∞–º–∞–Ω—Ü—è. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ç–∞–º.
  </p>
  
  <div id="tonconnect-ui-button" style="margin-top: 20px;"></div>
  
  <p id="wallet-status" style="margin-top:10px">–©–µ –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ.</p>
</div>

<div class="card">
  <h3>Balance</h3>
  <p><strong>–ê–¥—Ä–µ—Å–∞:</strong> <span id="addr">‚Äî</span></p>
  <p><strong>–ú–µ—Ä–µ–∂–∞:</strong> <span id="net">‚Äî</span></p>
  <p><strong>–ë–∞–ª–∞–Ω—Å:</strong> <span id="bal">‚Äî</span> TON</p>
  <button id="btn-refresh" class="btn btn-secondary" disabled>–û–Ω–æ–≤–∏—Ç–∏</button>
</div>

<div class="card">
  <h3>Stake in Pool</h3>
  <p>–û–±–µ—Ä—ñ—Ç—å –ø—É–ª –∑ –∫–∞—Ç–∞–ª–æ–≥—É —ñ –≤–≤–µ–¥—ñ—Ç—å —Å—É–º—É –≤ TON. 
     –î–µ–ª–µ–≥–∞—Ü—ñ—è –ø—ñ–¥–ø–∏—Å—É—î—Ç—å—Å—è –≤–∏–∫–ª—é—á–Ω–æ —É –≤–∞—à–æ–º—É –≥–∞–º–∞–Ω—Ü—ñ (–º–∏ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –∫–æ—à—Ç–∏).</p>

  <div class="stake-form">
    <div class="form-group">
      <label for="pool-select"><strong>Pool</strong></label>
      <select id="pool-select" name="pool">
        <!-- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ -->
      </select>
    </div>

    <div class="form-group">
      <label for="amount"><strong>–°—É–º–∞ (TON)</strong></label>
      <input type="number" id="amount" name="amount" min="1" step="0.01" placeholder="–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: 100">
    </div>

    <button id="btn-stake" class="btn btn-primary" disabled>Stake TON</button>
  </div>
</div>

<script>
// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—É–ª—ñ–≤ –¥–ª—è —Å–µ–ª–µ–∫—Ç—É
fetch('/api/pools')
  .then(r => r.json())
  .then(data => {
    const sel = document.getElementById('pool-select');
    if (data.items && data.items.length > 0) {
      data.items.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.address;
        opt.textContent = `${p.name} (${(p.fee * 100).toFixed(1)}% fee)`;
        sel.appendChild(opt);
      });
    }
  });
</script>
{% endblock %}
